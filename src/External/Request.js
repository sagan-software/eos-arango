// Generated by BUCKLESCRIPT VERSION 4.0.0, PLEASE EDIT WITH CARE
'use strict';

var Js_dict = require("bs-platform/lib/js/js_dict.js");
var Js_option = require("bs-platform/lib/js/js_option.js");
var Js_primitive = require("bs-platform/lib/js/js_primitive.js");
var Caml_exceptions = require("bs-platform/lib/js/caml_exceptions.js");
var RequestPromise = require("request-promise");

function header(t, key) {
  return Js_primitive.undefined_to_opt(t.headers[key]);
}

var Options = /* module */[];

var TimedOut = Caml_exceptions.create("Request.TimedOut");

var UnknownError = Caml_exceptions.create("Request.UnknownError");

var $$Error = /* module */[];

function make(url, $staropt$star, $staropt$star$1, body, $staropt$star$2, headers, $staropt$star$3, time, _) {
  var method__ = $staropt$star !== undefined ? $staropt$star : "GET";
  var json = $staropt$star$1 !== undefined ? $staropt$star$1 : false;
  var timeout = $staropt$star$2 !== undefined ? $staropt$star$2 : 0;
  var encoding = $staropt$star$3 !== undefined ? Js_primitive.valFromOption($staropt$star$3) : undefined;
  var tmp = {
    url: url,
    method: method__,
    json: json,
    resolveWithFullResponse: true,
    simple: false,
    timeout: timeout,
    headers: Js_dict.fromArray(Js_option.getWithDefault(/* array */[], headers)),
    encoding: encoding
  };
  if (body) {
    tmp.body = Js_primitive.valFromOption(body);
  }
  if (time) {
    tmp.time = Js_primitive.valFromOption(time);
  }
  return RequestPromise(tmp).catch((function (e) {
                var match = e.error.code;
                var tmp = match === "ETIMEDOUT" ? [
                    TimedOut,
                    url
                  ] : [
                    UnknownError,
                    e
                  ];
                return Promise.reject(tmp);
              }));
}

var TimingPhases = /* module */[];

var Timings = /* module */[];

exports.header = header;
exports.Options = Options;
exports.TimedOut = TimedOut;
exports.UnknownError = UnknownError;
exports.$$Error = $$Error;
exports.make = make;
exports.TimingPhases = TimingPhases;
exports.Timings = Timings;
/* Js_dict Not a pure module */
